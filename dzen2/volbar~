#!/bin/bash

UPDATE=1
TEXTCOL="#aaaaaa"

VOLUME_ICONCOL="#606060"
SEPCOL="#707070"
ICON="^i(.dwm/dzen2/icons/vol-hi.xbm)"
ICON2="^i(.dwm/dzen2/icons/vol-mute.xbm)"
LCOR="^i(/home/cas/.xmonad/dzen2/icons/myicons/corner-left.xbm)"
RCOR="^i(/home/cas/.xmonad/dzen2/icons/myicons/corner-right.xbm)"

COUNT=0
BARLENGTH=33

sleep 3
while :;  do

    # Volume
	VOL=`amixer sget Master | grep Mono: | awk '{print $4 $6}' | sed -e 's/\%//g' | sed -e 's/\[//' | sed -e 's/\]//' ` 	
	ON=`echo $VOL | grep "on"` 
	if [ "$ON" != "" ]; then 
		ON=`echo $VOL | sed -e 's/\[on\]//'`;
		VOL="$ON";
        ACTIVE=$(($VOL / 3))
        INACTIVE=$(($BARLENGTH-$ACTIVE))
	echo -n "^bg(#000000)^fg(#fff) VOL:^bg()^fg(#000000)$RCOR"
        echo -n "^fg(#303030)$LCOR^fg()" # left corner
	echo -n "^bg(#303030)^fg(#1874cd)^r("$ACTIVE"x6)^fg(#000)^r("$INACTIVE"x6)^fg($TEXTCOL) $VOL^fg()^bg()" # main area
	echo    "^fg(#303030)$RCOR" # right corner
	else
	ON=`echo $VOL | sed -e 's/\[off\]//'`;
	VOL=$ON;
        ACTIVE=$(($VOL / 3))
        INACTIVE=$(($BARLENGTH-$ACTIVE))
        echo -n "^bg(#000000)^fg(#fff) VOL:^bg()^fg(#303030)$RCOR"
        echo -n "^fg(#303030)$LCOR^fg()" # left corner
	echo -n "^bg(#303030)^fg(#707070)^r("$ACTIVE"x6)^fg(#000)^r("$INACTIVE"x6)^fg($TEXTCOL) $VOL^fg()^bg()" # main area
	echo    "^fg(#303030)$RCOR" # right corner
	fi


    
    
    
    
    #^fg($TEXTCOL)$VOL^fg()  " 

	
    sleep $UPDATE


done | dzen2 -x 1146  -y 0 -h 12 -w 210 -ta l -fg $SEPCOL -bg "#000000" -fn "-*-dejavu sans mono-medium-r-*-*-9-*-*-*-*-*-*-*"
